define(function() {
function encodeHTMLSource() {  var encodeHTMLRules = { "&": "&#38;", "<": "&#60;", ">": "&#62;", '"': '&#34;', "'": '&#39;', "/": '&#47;' },  matchHTML = /&(?!#?w+;)|<|>|"|'|\//g;  return function() {    return this ? this.replace(matchHTML, function(m) {return encodeHTMLRules[m] || m;}) : this;  };};
String.prototype.encodeHTML=encodeHTMLSource();
var tmpl = {};
  tmpl['compositeRouter']=function anonymous(it) {
var out='define([\'backbone\',\'jquery\',';var arr1=it.imports;if(arr1){var _import,index=-1,l1=arr1.length-1;while(index<l1){_import=arr1[index+=1];out+='\''+(_import.view.path)+'\',\''+(_import.model.path)+'\'';if(index !== it.imports.length - 1){out+=',';}} } out+='], function(Backbone,$,';var arr2=it.imports;if(arr2){var _import,index=-1,l2=arr2.length-1;while(index<l2){_import=arr2[index+=1];out+=(_import.view.name)+','+(_import.model.name);if(index !== it.imports.length - 1){out+=',';}} } out+=') {var Constructor = Backbone.Router.extend({routes : {';var arr3=it.pages;if(arr3){var page,index=-1,l3=arr3.length-1;while(index<l3){page=arr3[index+=1];out+='\''+(page.path)+'\' : \'compose '+(page.path)+'\'';if(index !== it.pages.length - 1){out+=',';}} } out+='},';var arr4=it.pages;if(arr4){var page,index=-1,l4=arr4.length-1;while(index<l4){page=arr4[index+=1];out+='\'compose '+(page.path)+'\' : function() {var _this = this, incorrectRegions = 0, n = 0;'+(page.contentScripts)+'},';} } var arr5=it.pages;if(arr5){var page,index=-1,l5=arr5.length-1;while(index<l5){page=arr5[index+=1];out+='\'render '+(page.path)+'\' : function() {this.emit(\'onrenderstart\');if(document.querySelectorAll(\'[data-layout='+(page.layout)+']\').length) {'+(page.renderScripts)+'return;}app.$layout.remove();app.$body.append(app.layoutTmpls.'+(page.layout)+'({'+(page.mapScripts)+'}));this.emit(\'onrenderend\');},';} } out+='emit : function(message) {app.document.emit(message);}});Constructor.prototype.content = {};return Constructor;});';return out;
};
  tmpl['contentScripts']=function anonymous(it) {
var out='';var arr1=it;if(arr1){var content,index=-1,l1=arr1.length-1;while(index<l1){content=arr1[index+=1];out+='if(typeof app.models.'+(content.model.toLowerCase())+' === \'undefined\') {var '+(content.model.toLowerCase())+' = new '+(content.model)+';app.views.'+(content.model.toLowerCase())+'  = new '+(content.view)+'('+(content.model.toLowerCase())+');if(!'+(content.model.toLowerCase())+'.bootstrapped) {incorrectRegions++;try {'+(content.model.toLowerCase())+'.fetch({success: function() {_this.content[\''+(content.region)+'\'] = '+(content.view)+'.prototype.template('+(content.model.toLowerCase())+'.toJSON());n++;if(n === incorrectRegions) _this[\'render '+(content.path)+'\']();}});}catch(err) {if(err.message === \'A "url" property or function must be specified\') {_this.content[\''+(content.region)+'\'] = '+(content.view)+'.prototype.template('+(content.model.toLowerCase())+'.toJSON());n++;if(n === incorrectRegions) _this[\'render '+(content.path)+'\']();}else {console.log(err);}}}app.models.'+(content.model.toLowerCase())+' = '+(content.model.toLowerCase())+';}';} } return out;
};
  tmpl['mapScripts']=function anonymous(it) {
var out='';var arr1=it;if(arr1){var content,index=-1,l1=arr1.length-1;while(index<l1){content=arr1[index+=1];out+=(content.region)+' : this.content[\''+(content.model.toLowerCase())+'\']';if(index !== it.length - 1){out+=',';}} } return out;
};
  tmpl['renderScripts']=function anonymous(it) {
var out='';var arr1=it;if(arr1){var content,index=-1,l1=arr1.length-1;while(index<l1){content=arr1[index+=1];out+='if(!document.querySelector(\'[data-region='+(content.region)+'] [data-content='+(content.model.toLowerCase())+']\')) {document.querySelector(\'[data-region='+(content.region)+']\').innerHTML = this.content[\''+(content.region)+'\'];}';} } return out;
};
  tmpl['jsonScript']=function anonymous(it) {
var out='<script type="application/json" class="js-json-'+(it.name)+'">'+(it.json)+'</script>';return out;
};
return tmpl;});
